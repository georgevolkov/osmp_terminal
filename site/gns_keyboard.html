<html>
<head>
	<title>Groups/Providers</title>
	<meta http-equiv="content-type" content="text/html; charset=windows-1251" />
	<meta http-equiv="refresh" content="180; URL=./index.html" />
	<link rel="stylesheet" href="./css/gr_prv.css" type="text/css" />

        <script src="./func/ui/translate/translate.js" type="text/javascript"></script>
        <script src="./func/ui/translate/properties.js" type="text/javascript"></script>
        <script src="./func/ui/translate/locale/ru_ru.js" type="text/javascript"></script>
        <script src="./func/ui/translate/locale/en_en.js" type="text/javascript"></script>
        <script src="./func/ui/translate/locale/kg.js" type="text/javascript"></script>
        <script src="./func/ui/translate/locale/prvlocale.js" type="text/javascript"></script>
        <script src="./func/engine/pars_cookie.js"></script>
        <script src="./prv_validate.js"></script>

	<script src="./func/engine/new_engine/utils.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/storage.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/base.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/data.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/pages.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/pages.tabs.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/pages.provider.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/keyboards.js" type="text/javascript"></script>
	<script src="./func/engine/new_engine/fields.js" type="text/javascript"></script>
	<script src="./advert.js" type="text/javascript"></script>
        <script src="./advert_content.js" type="text/javascript"></script>
	<script type="text/javascript" src="./func/engine/new_engine/hyphen.js"></script>
        
	<script type="text/javascript">

var js = null;
var head = null;
var sLocale = "ru_ru";

function getProviderInformation() {
    sLocale = getcookie('locale');
    var prvId = storage.get("prv_id");
    var validateValues = setValidateArray()[prvId];
    var invitation = (storage.get('prv_invitation') ? getText(storage.get('prv_invitation'), sLocale) : "" );    
	storage.put("prov","true");
    var oProvider = {
        "buttonName":storage.get("prv_name"),
        "charity_logo":storage.get("prv_image"),
        "id":storage.get("prv_id"),
        "logo":storage.get("prv_image"),
        "minSum":validateValues["minSum"],
        "maxSum":validateValues["maxSum"],
        "sName":storage.get("prv_name"),
        "small_logo":storage.get("prv_image"),
        "__objects":[
            {
                "__type":"constParams"
            },
            {
                "__type":"pages",
                "__objects":[
                    {
                        "pageId":"1",
                        "__objects":[
                            {
                                "__type":"controls",
                                "__objects":[
                                    {
                                        "footer":"",
                                        "header":invitation,
                                        "mask":storage.get('prv_mask'),
                                        "name":"account",
                                        "nobr":"false",
                                        "regexp":validateValues["mask"].source,
                                        "strip":"false",
                                        "type":"text_input"
                                    },
                                    {
                                        "layout":"AL",
                                        "type":"keyboard"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ]
    };

    return oProvider;
}

function init() {
	/*var prvId = storage.get("provider");
	if(prvId)
	{
		getScript("./config/" + storage.get("provider") + ".js", start);
	}
	else
	{
		top.location.href = "./index.html";
	}*/
		
        start();
}

function start() {
    var oProvider = null;
    try {
        //oProvider = window.UIProvider.clone();
        oProvider = getProviderInformation(); 
        (new CJsDataProvider).modifyProvider(oProvider);
    }
    catch (e) {        
    	console.debug(e);
    }
    
    if (head && js)
        head.removeChild(js);
    
    if ($isNoU(oProvider)) {        
        document.location.href = "./index.html";
    }
    else {        
        var page = newObject(CProviderPage, null, null, null, "page", "content", oProvider);
        
        page.render();
    }
}

    </script>
</head>
<body onload="init();">
	<div id="content" style="width: 1280px; height: 1024px;"></div>
	<form name="ff" id="ff" method="post" action="#">
		<input name="disp1" id="disp1" type="hidden" value="" />
		<input name="disp2" id="disp2" type="hidden" value="" />
		<input name="disp3" id="disp3" type="hidden" value="" />
		<input name="disp4" id="disp4" type="hidden" value="" />
		<input name="disp5" id="disp5" type="hidden" value="" />
		<input name="disp6" id="disp6" type="hidden" value="" />
		<input name="disp7" id="disp7" type="hidden" value="" />
		<input name="disp8" id="disp8" type="hidden" value="" />
		<input name="disp9" id="disp9" type="hidden" value="" />
		<input name="disp10" id="disp10" type="hidden" value="" />
		<input name="disp11" id="disp11" type="hidden" value="" />
		<input name="disp12" id="disp12" type="hidden" value="" />
		<input name="disp13" id="disp13" type="hidden" value="" />
		<input name="disp14" id="disp14" type="hidden" value="" />
		<input name="disp15" id="disp15" type="hidden" value="" />
		<input name="disp16" id="disp16" type="hidden" value="" />
		<input name="disp17" id="disp17" type="hidden" value="" />
		<input name="disp18" id="disp18" type="hidden" value="" />
		<input name="disp19" id="disp19" type="hidden" value="" />
		<input name="disp20" id="disp20" type="hidden" value="" />
	</form>
</body>
</html>
